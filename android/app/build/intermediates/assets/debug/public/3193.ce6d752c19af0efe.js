"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3193],{3193:(x,A,l)=>{l.r(A),l.d(A,{AgregarProductorPageModule:()=>U});var Z=l(6814),t=l(95),n=l(7027),p=l(2891),f=l(5861),e=l(5879),v=l(6796),I=l(8330),T=l(7523),y=l(6240);function b(a,s){1&a&&(e.TgZ(0,"ion-item")(1,"ion-label",18),e._uU(2,"Por favor, introduce un nombre v\xe1lido"),e.qZA()())}const k=[{path:"",component:(()=>{var a;class s{constructor(r,o,i,c,d,h,P,u){this.toastController=r,this.fb=o,this.afAuth=i,this.afs=c,this.db=d,this.router=h,this.storage=P,this.loadingController=u,this.sucursales=[],this.departamentos=[],this.departamentosFiltrados=[],this.selectedImage=null,this.imagePreview="../../../assets/img/add-image.png",this.empleadoForm=this.fb.group({nombre:["",[t.kI.required,t.kI.maxLength(45)]],apellido_p:["",[t.kI.required,t.kI.maxLength(45)]],apellido_m:["",[t.kI.required,t.kI.maxLength(45)]],telefono:["",[t.kI.required,t.kI.maxLength(10)]],localidad:["",[t.kI.required,t.kI.maxLength(70)]],estado:["",[t.kI.required,t.kI.maxLength(70)]]})}ngOnInit(){}oonImageSelected(r){const o=r.target;if(o.files&&o.files[0]){if(this.selectedImage=o.files[0],!this.selectedImage.type.startsWith("image/"))return this.presentToast("Por favor, selecciona una imagen v\xe1lida"),void(this.selectedImage=null);this.previewImage(this.selectedImage)}else this.selectedImage=null}previewImage(r){const o=new FileReader;o.onload=()=>{this.imagePreview=o.result},o.readAsDataURL(r)}registerProductor(){var r=this;return(0,f.Z)(function*(){if(r.empleadoForm.valid&&r.selectedImage){const{nombre:o,apellido_p:i,apellido_m:c,telefono:d,localidad:h,estado:P}=r.empleadoForm.value,u=yield r.presentLoading("Registrando productor...");try{const m=`productorImages/${(new Date).getTime()}_${r.selectedImage.name}`,q=r.storage.ref(m);yield r.storage.upload(m,r.selectedImage).snapshotChanges().toPromise();const F=yield q.getDownloadURL().toPromise();yield r.db.list("PRODUCTORES").push({nombre:o,apellido_p:i,apellido_m:c,telefono:d,localidad:h,estado:P,imageUrl:F}),u.dismiss(),r.presentToast("Productor registrado con \xe9xito"),r.router.navigate(["/clientes"])}catch(m){u.dismiss(),console.error("Error:",m),r.presentToast("Error al registrar productor")}}else r.presentToast("Por favor, rellena el formulario correctamente")})()}presentLoading(r){var o=this;return(0,f.Z)(function*(){const i=yield o.loadingController.create({message:r,spinner:"crescent",backdropDismiss:!1});return yield i.present(),i})()}presentToast(r){var o=this;return(0,f.Z)(function*(){(yield o.toastController.create({message:r,duration:2e3})).present()})()}}return(a=s).\u0275fac=function(r){return new(r||a)(e.Y36(n.yF),e.Y36(t.qu),e.Y36(v.zQ),e.Y36(I.ST),e.Y36(T.KQ),e.Y36(p.F0),e.Y36(y.Q1),e.Y36(n.HT))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-agregar-productor"]],decls:31,vars:5,consts:[[3,"translucent"],["color","primary"],["slot","start"],["defaultHref","/clientes","color","secondary"],["fullscreen",""],[3,"formGroup"],["alt","Click para seleccionar una imagen",2,"width","95px","height","95px","cursor","pointer","margin","0 auto","margin-bottom","15px",3,"src","click"],["type","file",2,"display","none",3,"change"],["fileInput",""],["formControlName","nombre","label","Nombre:","maxlength","45","required",""],[4,"ngIf"],["formControlName","apellido_p","label","Apellido Paterno:","maxlength","45","required",""],["formControlName","apellido_m","label","Apellido Materno:","maxlength","45","required",""],["formControlName","telefono","label","Tel\xe9fono:","onkeypress","return (event.charCode >= 48 && event.charCode <= 57)","maxlength","10","required",""],["formControlName","localidad","label","Localidad:","maxlength","70","required",""],["formControlName","estado","label","Estado:","maxlength","70","required",""],[1,"btn"],["color","secondary",2,"max-width","200px","margin","0 auto",3,"disabled","click"],["color","danger","position","stacked"]],template:function(r,o){if(1&r){const i=e.EpF();e.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2),e._UZ(3,"ion-back-button",3),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5,"Agregar Productor"),e.qZA()()(),e.TgZ(6,"ion-content",4)(7,"h1"),e._uU(8,"Agregar Datos Productor"),e.qZA(),e.TgZ(9,"form",5)(10,"ion-list")(11,"ion-item")(12,"img",6),e.NdJ("click",function(){e.CHM(i);const d=e.MAs(14);return e.KtG(d.click())}),e.qZA(),e.TgZ(13,"input",7,8),e.NdJ("change",function(d){return o.oonImageSelected(d)}),e.qZA()(),e.TgZ(15,"ion-item"),e._UZ(16,"ion-input",9),e.qZA(),e.YNc(17,b,3,0,"ion-item",10),e.TgZ(18,"ion-item"),e._UZ(19,"ion-input",11),e.qZA(),e.TgZ(20,"ion-item"),e._UZ(21,"ion-input",12),e.qZA(),e.TgZ(22,"ion-item"),e._UZ(23,"ion-input",13),e.qZA(),e.TgZ(24,"ion-item"),e._UZ(25,"ion-input",14),e.qZA(),e.TgZ(26,"ion-item"),e._UZ(27,"ion-input",15),e.qZA(),e.TgZ(28,"div",16)(29,"ion-button",17),e.NdJ("click",function(){return o.registerProductor()}),e._uU(30,"Registrar Productor"),e.qZA()()()()()}if(2&r){let i;e.Q6J("translucent",!0),e.xp6(9),e.Q6J("formGroup",o.empleadoForm),e.xp6(3),e.Q6J("src",o.imagePreview,e.LSH),e.xp6(5),e.Q6J("ngIf",(null==(i=o.empleadoForm.get("nombre"))?null:i.invalid)&&((null==(i=o.empleadoForm.get("nombre"))?null:i.dirty)||(null==(i=o.empleadoForm.get("nombre"))?null:i.touched))),e.xp6(12),e.Q6J("disabled",o.empleadoForm.invalid)}},dependencies:[Z.O5,t._Y,t.JJ,t.JL,t.Q7,t.nD,n.oU,n.YG,n.Sm,n.W2,n.Gu,n.pK,n.Ie,n.Q$,n.q_,n.wd,n.sr,n.j9,n.cs,t.sg,t.u]}),s})()}];let C=(()=>{var a;class s{}return(a=s).\u0275fac=function(r){return new(r||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[p.Bz.forChild(k),p.Bz]}),s})(),U=(()=>{var a;class s{}return(a=s).\u0275fac=function(r){return new(r||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[Z.ez,t.u5,n.Pc,C,t.UX]}),s})()}}]);