"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7919],{7919:(b,h,s)=>{s.r(h),s.d(h,{InsumosPageModule:()=>T});var p=s(6814),f=s(95),e=s(7027),m=s(2891),d=s(5861),t=s(5879),v=s(7523),I=s(6240);function Z(n,i){if(1&n){const r=t.EpF();t.TgZ(0,"ion-col",8)(1,"ion-card",9),t.NdJ("click",function(){const c=t.CHM(r).$implicit,u=t.oxw();return t.KtG(u.presentActionSheet(c))}),t._UZ(2,"img",10),t.TgZ(3,"ion-card-header")(4,"ion-card-title"),t._uU(5),t.qZA()(),t.TgZ(6,"ion-card-content")(7,"h2"),t._uU(8),t.qZA(),t.TgZ(9,"h2"),t._uU(10),t.qZA(),t.TgZ(11,"h2"),t._uU(12),t.qZA(),t.TgZ(13,"h2"),t._uU(14),t.qZA()()()()}if(2&n){const r=i.$implicit;t.xp6(2),t.Q6J("src",r.imageUrl,t.LSH),t.xp6(3),t.Oqu(r.nombre),t.xp6(3),t.hij("Clave: ",r.clave,""),t.xp6(2),t.hij("Unidad: ",r.unidad,""),t.xp6(2),t.hij("Existencia: ",r.existencia,""),t.xp6(2),t.hij("Precio: ",r.precio,"")}}const x=function(){return["/agregar-insumo"]},y=[{path:"",component:(()=>{var n;class i{constructor(o,a,c,u,l,g){this.actionSheetCtrl=o,this.router=a,this.alertController=c,this.db=u,this.storage=l,this.toastController=g,this.insumos=[]}presentActionSheet(o){var a=this;return(0,d.Z)(function*(){yield(yield a.actionSheetCtrl.create({header:"Opciones De Insumo",backdropDismiss:!1,buttons:[{text:"Eliminar Insumo",role:"destructive",data:{action:"delete"},handler:()=>{a.eliminacion(o)}},{text:"Actualizar Infromaci\xf3n",data:{action:"actualizarDatos"},handler:()=>{a.actualizarDatos(o)}},{text:"Ver Ventas Realizadas",data:{action:"actualizarDatos"},handler:()=>{a.verDepartamentos()}},{text:"Cerrar",role:"cancel",data:{action:"cancel"}}]})).present()})()}presentToast(o,a){var c=this;return(0,d.Z)(function*(){(yield c.toastController.create({message:o,duration:2e3,color:a,position:"bottom"})).present()})()}eliminacion(o){var a=this;return(0,d.Z)(function*(){const c=yield a.alertController.create({header:"\xa1Advertencia!",message:"\xbfRealmente desea eliminar este insumo?",buttons:[{text:"S\xed",role:"confirm",handler:()=>{}},"No"]});yield c.present(),c.onDidDismiss().then(u=>{"confirm"===u.role&&a.db.object(`INSUMOS/${o.key}`).remove().then(()=>{let l=o.imageUrl.split("%2F")[1].split("?")[0];l=decodeURIComponent(l),a.storage.ref(`insumoImages/${l}`).delete().subscribe({next:()=>{a.presentToast("Insumo eliminado exitosamente","success")},error:g=>{console.error("Error al eliminar la imagen: ",g),a.presentToast("Error al eliminar la imagen","danger")}})}).catch(l=>{console.error("Error al eliminar el insumo: ",l),a.presentToast("Error al eliminar el insumo","danger")})})})()}actualizarDatos(o){this.router.navigate(["/actualizar-insumo",o.key])}verDepartamentos(){this.router.navigate(["/ventas"])}ngOnInit(){this.db.list("INSUMOS").snapshotChanges().subscribe(o=>{this.insumos=o.map(a=>({key:a.key,...a.payload.val()}))})}}return(n=i).\u0275fac=function(o){return new(o||n)(t.Y36(e.BX),t.Y36(m.F0),t.Y36(e.Br),t.Y36(v.KQ),t.Y36(I.Q1),t.Y36(e.yF))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-insumos"]],decls:14,vars:4,consts:[[3,"translucent"],["color","primary"],["slot","start"],["fullscreen",""],["slot","fixed","vertical","bottom","horizontal","end"],["color","secondary",3,"routerLink"],["name","add"],["size","6",4,"ngFor","ngForOf"],["size","6"],[1,"mis-tarjetas",3,"click"],[2,"width","150px","height","150px",3,"src"]],template:function(o,a){1&o&&(t.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2),t._UZ(3,"ion-back-button")(4,"ion-menu-button",2),t.qZA(),t.TgZ(5,"ion-title"),t._uU(6,"Insumos"),t.qZA()()(),t.TgZ(7,"ion-content",3)(8,"ion-fab",4)(9,"ion-fab-button",5),t._UZ(10,"ion-icon",6),t.qZA()(),t.TgZ(11,"ion-grid")(12,"ion-row"),t.YNc(13,Z,15,6,"ion-col",7),t.qZA()()()),2&o&&(t.Q6J("translucent",!0),t.xp6(9),t.Q6J("routerLink",t.DdM(3,x)),t.xp6(4),t.Q6J("ngForOf",a.insumos))},dependencies:[p.sg,e.oU,e.Sm,e.PM,e.FN,e.Zi,e.Dq,e.wI,e.W2,e.IJ,e.W4,e.jY,e.Gu,e.gu,e.fG,e.Nd,e.wd,e.sr,e.cs,e.YI,m.rH],styles:['@charset "UTF-8";.mis-tarjetas[_ngcontent-%COMP%]{height:350px;overflow-y:auto}ion-fab[_ngcontent-%COMP%]{margin-bottom:20px}']}),i})()}];let P=(()=>{var n;class i{}return(n=i).\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[m.Bz.forChild(y),m.Bz]}),i})(),T=(()=>{var n;class i{}return(n=i).\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[p.ez,f.u5,e.Pc,P]}),i})()}}]);