"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8060],{8060:(U,I,s)=>{s.r(I),s.d(I,{AgregarInsumoPageModule:()=>x});var v=s(6814),r=s(95),n=s(7027),p=s(2891),h=s(5861),e=s(5879),A=s(6796),Z=s(8330),P=s(7523),y=s(6240);const T=[{path:"",component:(()=>{var a;class l{constructor(t,o,i,u,m,f,d,c){this.toastController=t,this.fb=o,this.afAuth=i,this.afs=u,this.db=m,this.router=f,this.storage=d,this.loadingController=c,this.sucursales=[],this.departamentos=[],this.departamentosFiltrados=[],this.selectedImage=null,this.imagePreview="../../../assets/img/add-image.png",this.empleadoForm=this.fb.group({nombre:["",[r.kI.required,r.kI.maxLength(50)]],clave:["",[r.kI.required,r.kI.maxLength(45)]],unidad:["",[r.kI.required,r.kI.maxLength(5)]],precio:["",[r.kI.required,r.kI.maxLength(5),r.kI.pattern("^[0-9]*$")]],existencia:["",[r.kI.required,r.kI.maxLength(5),r.kI.pattern("^[0-9]*$")]]})}ngOnInit(){}oonImageSelected(t){const o=t.target;if(o.files&&o.files[0]){if(this.selectedImage=o.files[0],!this.selectedImage.type.startsWith("image/"))return this.presentToast("Por favor, selecciona una imagen v\xe1lida"),void(this.selectedImage=null);this.previewImage(this.selectedImage)}else this.selectedImage=null}previewImage(t){const o=new FileReader;o.onload=()=>{this.imagePreview=o.result},o.readAsDataURL(t)}registerProductor(){var t=this;return(0,h.Z)(function*(){if(t.empleadoForm.valid&&t.selectedImage){const{nombre:o,clave:i,unidad:u,precio:m,existencia:f}=t.empleadoForm.value,d=yield t.presentLoading("Registrando insumo...");try{const c=`insumoImages/${(new Date).getTime()}_${t.selectedImage.name}`,k=t.storage.ref(c);yield t.storage.upload(c,t.selectedImage).snapshotChanges().toPromise();const C=yield k.getDownloadURL().toPromise();yield t.db.list("INSUMOS").push({nombre:o,clave:i,unidad:u,precio:m,existencia:f,imageUrl:C}),d.dismiss(),t.presentToast("Insumo registrado con \xe9xito"),t.router.navigate(["/insumos"])}catch(c){d.dismiss(),console.error("Error:",c),t.presentToast("Error al registrar insumo")}}else t.presentToast("Por favor, rellena el formulario correctamente")})()}presentLoading(t){var o=this;return(0,h.Z)(function*(){const i=yield o.loadingController.create({message:t,spinner:"crescent",backdropDismiss:!1});return yield i.present(),i})()}presentToast(t){var o=this;return(0,h.Z)(function*(){(yield o.toastController.create({message:t,duration:2e3})).present()})()}}return(a=l).\u0275fac=function(t){return new(t||a)(e.Y36(n.yF),e.Y36(r.qu),e.Y36(A.zQ),e.Y36(Z.ST),e.Y36(P.KQ),e.Y36(p.F0),e.Y36(y.Q1),e.Y36(n.HT))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-agregar-insumo"]],decls:28,vars:4,consts:[[3,"translucent"],["color","primary"],["slot","start"],["defaultHref","/insumos","color","secondary"],["fullscreen",""],[3,"formGroup"],["alt","Click para seleccionar una imagen",2,"width","95px","height","95px","cursor","pointer","margin","0 auto","margin-bottom","15px",3,"src","click"],["type","file",2,"display","none",3,"change"],["fileInput",""],["formControlName","nombre","label","Nombre:","maxlength","50","required",""],["formControlName","clave","label","Clave:","maxlength","45","required",""],["formControlName","unidad","label","Unidad:","maxlength","5","required",""],["formControlName","precio","label","Precio","type","number","maxlength","5","required",""],["formControlName","existencia","label","Existencia","type","number","maxlength","5","required",""],[1,"btn"],["color","secondary",2,"max-width","200px","margin","0 auto",3,"disabled","click"]],template:function(t,o){if(1&t){const i=e.EpF();e.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2),e._UZ(3,"ion-back-button",3),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5,"Registrar Insumo"),e.qZA()()(),e.TgZ(6,"ion-content",4)(7,"h1"),e._uU(8,"Registro De Insumo"),e.qZA(),e.TgZ(9,"form",5)(10,"ion-list")(11,"ion-item")(12,"img",6),e.NdJ("click",function(){e.CHM(i);const m=e.MAs(14);return e.KtG(m.click())}),e.qZA(),e.TgZ(13,"input",7,8),e.NdJ("change",function(m){return o.oonImageSelected(m)}),e.qZA()(),e.TgZ(15,"ion-item"),e._UZ(16,"ion-input",9),e.qZA(),e.TgZ(17,"ion-item"),e._UZ(18,"ion-input",10),e.qZA(),e.TgZ(19,"ion-item"),e._UZ(20,"ion-input",11),e.qZA(),e.TgZ(21,"ion-item"),e._UZ(22,"ion-input",12),e.qZA(),e.TgZ(23,"ion-item"),e._UZ(24,"ion-input",13),e.qZA(),e.TgZ(25,"div",14)(26,"ion-button",15),e.NdJ("click",function(){return o.registerProductor()}),e._uU(27,"Registrar Insumo"),e.qZA()()()()()}2&t&&(e.Q6J("translucent",!0),e.xp6(9),e.Q6J("formGroup",o.empleadoForm),e.xp6(3),e.Q6J("src",o.imagePreview,e.LSH),e.xp6(14),e.Q6J("disabled",o.empleadoForm.invalid))},dependencies:[r._Y,r.JJ,r.JL,r.Q7,r.nD,n.oU,n.YG,n.Sm,n.W2,n.Gu,n.pK,n.Ie,n.q_,n.wd,n.sr,n.as,n.j9,n.cs,r.sg,r.u]}),l})()}];let b=(()=>{var a;class l{}return(a=l).\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[p.Bz.forChild(T),p.Bz]}),l})(),x=(()=>{var a;class l{}return(a=l).\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[v.ez,r.u5,n.Pc,b,r.UX]}),l})()}}]);